# QA Testing Workflow Guide

## What is this tool?

This tool helps QA teams track which ComfyUI custom node packs have been tested. Multiple testers work together in a **shared GitHub repository**, each testing different packs and sharing their results.

## How the Team Collaboration Works

This is a **shared repository** workflow:

- Everyone clones the same GitHub repo
- Each tester works on different node packs
- Test results are stored in git and shared via Pull Requests
- Other testers pull your updates to see what's been tested
- The repo is the single source of truth for the team

## The Files

### Checklists (checklists/your-project/)

- `checklist.md` - Simple markdown checklist with node pack names and counts
- `checklist-detailed.md` - Detailed version with individual node names
- These are **manually edited** by you to mark packs as tested
- **Stored in git** and shared with the team

### Workflows (workflows/)

- JSON files generated by the browser script
- Contain actual node definitions from live ComfyUI
- These are the **source of truth** for what actually exists
- **Stored in git** and shared with the team

## The Complete Workflow

### 1. Initial Setup (First Time Only)

```
Clone the shared GitHub repository
↓
cd into the repo folder
↓
Double-click START.bat (Windows) or START.command (Mac)
↓
Tool detects existing project OR creates new one
↓
You're ready to start testing
```

**Git commands:**

```bash
git clone https://github.com/Comfy-Org/comfyui-custom-node-qa.git
cd comfyui-custom-node-qa
# Double-click START.bat or START.command
```

### 2. Before You Start Testing (Pull Latest Changes)

```
Pull latest changes from GitHub
↓
See what others have tested
↓
Pick packs that aren't tested yet
↓
Start testing
```

**Git commands:**

```bash
git pull origin main
```

### 3. Testing a Node Pack

```
Open ComfyUI in your browser
↓
Open Developer Tools (F12)
↓
Paste the browser script (get from dashboard: "Get browser script")
↓
Run: await QA.testPack('pack-name')
↓
Browser downloads pack-name.json file
↓
Save that file to the workflows/ folder
↓
Open checklists/your-project/checklist.md
↓
Find the pack and change [ ] to [x]
↓
Save the file
```

### 4. Committing Your Work

```
Stage your changes
↓
Commit with descriptive message
↓
Push to your branch
↓
Create Pull Request on GitHub
↓
Team reviews and merges
```

**Git commands:**

```bash
git add workflows/pack-name.json
git add checklists/your-project/checklist.md
git commit -m "Tested pack-name: 42 nodes verified"
git push origin main
# Or if using branches:
git checkout -b test/pack-name
git push origin test/pack-name
# Then create PR on GitHub
```

### 3. What Each Command Does

#### Check Testing Progress

- Shows how many packs you've tested
- Lists which packs still need testing
- Highlights mismatches between checklist and workflow files

#### Get Browser Script

- Shows the JavaScript code to paste into browser DevTools
- This script adds the QA object with testing commands

#### View All Packs

- Browse all node packs
- Filter by: Tested, Untested, or Has Issues
- See details on individual packs

#### Compare with Repo (Diff)

- Compares your checklist.md against workflow/\*.json files
- Shows mismatches: "You marked this as 130 nodes, but the workflow file shows 129"
- Helps catch mistakes or outdated data

#### Run Validation

- Checks for format errors in your files
- Ensures checklist.md follows the correct format
- Validates JSON structure in workflow files

#### Sync Checklists

- **Overwrites your checklist.md** with fresh data from workflow files
- Use this when:
  - Workflow files are correct, checklist is wrong
  - You want to start fresh
  - Node counts changed and you want to update everything
- **WARNING**: Any manual edits to checklist will be lost!

## Common Scenarios

### Scenario 1: Your First Day as QA Tester

```
1. Clone the GitHub repo (link provided by your team)
2. cd into the repo folder
3. Run the tool (double-click START)
4. Select the project (or create if first tester)
5. Pull latest: git pull origin main
6. Check dashboard to see what's already tested
7. Get the browser script
8. Start testing untested packs
9. After each pack:
   - Save workflow JSON
   - Mark [x] in checklist
   - git add, commit, push
   - Create PR (or push to main if allowed)
```

### Scenario 2: Starting Your Day

```
1. cd to repo folder
2. git pull origin main  (get others' updates!)
3. Run the tool
4. Check dashboard - see new tested packs from teammates
5. Pick untested packs to work on
6. Test, commit, push, repeat
```

### Scenario 3: Node Pack Updated (Nodes Added/Removed)

```
1. Re-test the pack: await QA.testPack('pack-name')
2. Save new workflow file (overwrite old one)
3. Run "Compare with repo" - see the mismatch
4. Option A: Manually update the number in checklist.md
5. Option B: Run "Sync" to auto-update from workflow files
6. Commit: git add, commit, push
7. Create PR explaining what changed
```

### Scenario 4: Teammate Tested Same Pack

```
1. You: Test pack-A, commit, try to push
2. Git says: "Updates were rejected" (conflict!)
3. git pull origin main
4. Git shows merge conflict in checklist.md
5. Open checklist.md, resolve conflict (keep both [x] marks)
6. git add, commit, push
7. Both your tests are now recorded
```

### Scenario 5: Starting a New Project

```
1. Your team decides to test a new custom node
2. Someone: git clone the QA repo
3. Run tool, create new project for that node
4. git add checklists/new-project/
5. git commit -m "Created project for new-node testing"
6. git push, create PR
7. Team merges, everyone pulls
8. Everyone can now collaborate on testing that project
```

### Scenario 6: Checklist is Totally Wrong

```
1. Make sure your workflow/*.json files are correct and up-to-date
2. Run "Sync checklists"
3. Preview the changes (dry run)
4. Apply sync
5. All checklists regenerated from workflow files
6. git add checklists/
7. git commit -m "Synced checklists from workflow files"
8. git push, create PR explaining why sync was needed
```

## Key Concepts

### Source of Truth

- **Workflow JSON files** = what actually exists in ComfyUI right now
- **Checklist markdown** = what you've tested and marked as complete
- The tool compares these two to find mismatches

### Manual vs Automatic

- **Manual**: Editing checklist.md to mark [x] as tested
- **Automatic**: Sync command regenerates entire checklist from workflows

### Local vs Git

- This tool works **locally** on your computer
- **Git is essential** for team collaboration
- Always pull before testing to see others' work
- Always commit and push your results to share with team
- The GitHub repo is where all team progress is stored

### When to Use Sync

- **DO use sync when**: Workflow files are up-to-date, checklist is wrong
- **DON'T use sync when**: You've manually marked things as tested and want to keep that

## Troubleshooting

### "Count mismatch" - What does this mean?

Your checklist says a pack has X nodes, but the workflow file says Y nodes.

- Either the workflow file is outdated (re-test the pack)
- Or the checklist is outdated (edit manually or sync)

### "Workflow file missing"

You marked a pack as tested [x] but there's no JSON file for it.

- Did you forget to save the workflow file?
- Run await QA.testPack('pack-name') again

### "I synced and lost my [x] marks!"

Sync overwrites the entire checklist. The workflow JSON files don't store which packs are tested.

- Always preview (dry run) before syncing
- Consider manually editing instead of syncing
- Use git to recover previous version if needed

## Git Basics for Non-Technical Users

If you've never used git before, here's what you need to know:

### What is Git?

Git is like "track changes" for code. It lets multiple people work on the same files without overwriting each other's work.

### Essential Commands

**Getting the repo (first time only):**

```bash
git clone https://github.com/Comfy-Org/comfyui-custom-node-qa.git
cd comfyui-custom-node-qa
```

**Starting your work (every time):**

```bash
git pull origin main
```

This downloads everyone else's latest changes.

**Saving your work:**

```bash
git add .
git commit -m "Describe what you did"
git push origin main
```

- `git add .` = Mark all your changes to be saved
- `git commit` = Save a snapshot with a description
- `git push` = Upload to GitHub for others to see

**Checking what changed:**

```bash
git status
```

Shows which files you modified.

**If push fails (someone else pushed first):**

```bash
git pull origin main
# Fix any conflicts if needed
git push origin main
```

### Platform-Specific Notes

**Windows:**

- Use Git Bash (comes with Git for Windows) or PowerShell
- Double-click `START.bat` to launch tool

**Mac:**

- Use Terminal app
- May need to allow `START.command` in Security & Privacy settings
- Run `chmod +x START.command` if permission denied

**Linux:**

- Use any terminal
- Run `chmod +x START.sh` first time
- Some distros: `./START.sh` or `bash START.sh`

## Tips

1. **Always pull before testing** - See what teammates just finished
2. **Test frequently, commit frequently** - Don't wait until you've tested 50 packs
3. **Write clear commit messages** - "Tested ComfyUI-Lotus: 2 nodes verified"
4. **Check "Compare with repo" often** - Catch mistakes early
5. **Preview before sync** - Always dry run first
6. **Use git branches** - Keep experiments separate from main work (advanced)
7. **Ask for help** - If git conflicts happen, ask a teammate
8. **Pull at least daily** - Stay synced with the team
